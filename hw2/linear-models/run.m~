% You can use this skeleton or write your own.
% You are __STRONGLY__ suggest to run this script section-by-section using Ctrl+Enter.
% See http://www.mathworks.cn/cn/help/matlab/matlab_prog/run-sections-of-programs.html for more details.
%% Part5: Linear Regression: poly_fit
load('poly_train', 'X', 'y');
load('poly_test', 'X_test', 'y_test');
w = linear_regression(X, y)
% Compute training, testing error
% fprintf('E_train is %f, E_test is %f.\n', E_train, E_test);

% poly_fit with transform
% CHANGE THIS LINE TO DO TRANSFORMATION
X_t = [X;X(1,:).*X(2,:);X(1,:).*X(1,:);X(2,:).*X(2,:)];
w_g_t = linear_regression(X_t, y,150);
% CHANGE THIS LINE TO DO TRANSFORMATION
X_test_t = [X_test;X_test(1,:).*X_test(2,:);X_test(1,:).*X_test(1,:);X_test(2,:).*X_test(2,:)]; 
% Compute training, testing error
error_rate_test = errorrate(X_test_t,w_g_t,y_test);
error_rate_train = errorrate(X,w_g_t,y);
fprintf('E_train is %f, E_test is %f.\n', error_rate_train);
fprintf('E_train is %f, E_test is %f.\n', error_rate_test);

